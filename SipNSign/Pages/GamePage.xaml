<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:toolkit="http://schemas.microsoft.com/dotnet/2022/maui/toolkit"
             x:Class="com.kizwiz.sipnsign.Pages.GamePage"
             Title="SipNSign">

    <VerticalStackLayout Padding="20" Spacing="10">

        <!-- Score Display -->
        <Frame Padding="10" CornerRadius="5" HasShadow="True" BackgroundColor="#E0E0E0">
            <Label 
                x:Name="ScoreLabel"
                Text="{Binding CurrentScore}" 
                FontSize="24" 
                HorizontalOptions="Center" 
                VerticalOptions="Center" 
                TextColor="{DynamicResource PrimaryTextColor}" 
                SemanticProperties.HeadingLevel="Level1" 
                AutomationId="ScoreLabel" />
        </Frame>

        <!-- Sign Image (Optional: Display if image is available) -->
        <Frame Padding="5" CornerRadius="10" HasShadow="True" BackgroundColor="White" IsVisible="{Binding IsImageAvailable}">
            <Image 
                Source="{Binding CurrentSign.ImagePath}" 
                Aspect="AspectFit" 
                HeightRequest="200" 
                HorizontalOptions="Center" 
                VerticalOptions="CenterAndExpand" 
                AutomationId="SignImage" />
        </Frame>

        <!-- Sign Video -->
        <Frame Padding="5" CornerRadius="10" HasShadow="True" BackgroundColor="White" IsVisible="{Binding IsVideoAvailable}">
            <toolkit:MediaElement
                x:Name="SignVideo" 
                Source="{Binding CurrentSign.VideoPath}" 
                Aspect="AspectFit" 
                HeightRequest="200" 
                HorizontalOptions="Center" 
                VerticalOptions="CenterAndExpand"
                AutomationId="SignVideo"
                ShouldAutoPlay="True"
                ShouldLoopPlayback="True"/>
        </Frame>

        <!-- Choices for Answering -->
        <Label 
            Text="What does this sign mean?" 
            FontSize="18" 
            HorizontalOptions="Center" 
            VerticalOptions="Center" 
            TextColor="{DynamicResource PrimaryTextColor}" />

        <StackLayout 
            Orientation="Vertical" 
            HorizontalOptions="FillAndExpand" 
            Spacing="10">
            <!-- Answer Buttons -->
            <Button 
                x:Name="AnswerButton1"
                Text="{Binding CurrentSign.Choices[0]}" 
                Command="{Binding AnswerCommand}"
                CommandParameter="{Binding CurrentSign.Choices[0]}" 
                BackgroundColor="#007BFF"
                TextColor="White"
                HeightRequest="50"
                CornerRadius="10"
                AutomationId="AnswerButton1"/>
            <Button 
                x:Name="AnswerButton2"
                Text="{Binding CurrentSign.Choices[1]}" 
                Command="{Binding AnswerCommand}"
                CommandParameter="{Binding CurrentSign.Choices[1]}" 
                BackgroundColor="#007BFF"
                TextColor="White"
                HeightRequest="50"
                CornerRadius="10"
                AutomationId="AnswerButton2"/>
            <Button 
                x:Name="AnswerButton3"
                Text="{Binding CurrentSign.Choices[2]}" 
                Command="{Binding AnswerCommand}"
                CommandParameter="{Binding CurrentSign.Choices[2]}" 
                BackgroundColor="#007BFF"
                TextColor="White"
                HeightRequest="50"
                CornerRadius="10"
                AutomationId="AnswerButton3"/>
        </StackLayout>

        <!-- Feedback Label -->
        <Label 
            x:Name="FeedbackLabel"
            Text="{Binding FeedbackText}"
            FontSize="18"
            HorizontalOptions="Center"
            VerticalOptions="EndAndExpand"
            TextColor="{Binding FeedbackColor}" 
            AutomationId="FeedbackLabel" />

        <!-- Game Over Section -->
        <StackLayout x:Name="GameOverSection" IsVisible="{Binding IsGameOver}" HorizontalOptions="Center" VerticalOptions="Center">
            <Label 
                Text="Game Over!" 
                FontSize="24" 
                TextColor="Red"
                AutomationId="GameOverLabel" />
            <Label 
                Text="{Binding CurrentScore, StringFormat='Final Score: {0}'}" 
                FontSize="18" 
                TextColor="{DynamicResource PrimaryTextColor}" 
                AutomationId="FinalScoreLabel"/>
            <Button 
                Text="Play Again" 
                Command="{Binding PlayAgainCommand}" 
                BackgroundColor="#28a745"
                TextColor="White"
                HeightRequest="50"
                CornerRadius="10" />
        </StackLayout>

    </VerticalStackLayout>

</ContentPage>
